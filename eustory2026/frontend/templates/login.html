{% extends "base.html" %}

{% block content %}
<h2>Connexion</h2>

<form onsubmit="event.preventDefault(); login();">
    <input type="text" id="username" placeholder="Nom d'utilisateur" required>
    <input type="password" id="password" placeholder="Mot de passe" required>
    <button type="submit">Se connecter</button>
</form>

<script>
    function login() {
        fetch('/api/token/', {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                username: document.getElementById("username").value,
                password: document.getElementById("password").value
            })
        })
        .then(res => res.json())
        .then(data => {
            localStorage.setItem('token', data.access);
            window.location.href = '/';
        });
    }
</script>

{% endblock %}